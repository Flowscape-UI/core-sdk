# –ì–ª—É–±–æ–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

## üìä –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ü—Ä–æ–≤–µ–¥—ë–Ω –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**–ü–ª–∞–≥–∏–Ω—ã:**

- ‚úÖ `RulerPlugin` - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∏–Ω–µ–π–∫–∏
- ‚úÖ `RulerGuidesPlugin` - –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ –ª–∏–Ω–∏–∏
- ‚úÖ `RulerHighlightPlugin` - –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- ‚úÖ `GridPlugin` - —Å–µ—Ç–∫–∞ –∏ –ø—Ä–∏–≤—è–∑–∫–∞
- ‚úÖ `AreaSelectionPlugin` - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)
- ‚úÖ `SelectionPlugin` - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –Ω–æ–¥ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–ú–µ–Ω–µ–¥–∂–µ—Ä—ã:**

- ‚úÖ `CameraManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–æ–π –∏ –∑—É–º–æ–º
- ‚úÖ `NodeManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–¥–∞–º–∏ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã `_getActiveGuideInfo()`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–ª—Å—è **–¥–≤–∞–∂–¥—ã** –ø—Ä–∏ –∫–∞–∂–¥–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–µ (–¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–∏–Ω–µ–π–∫–∏), –≤—ã–ø–æ–ª–Ω—è—è –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∏–π –ø–æ–∏—Å–∫ –ø–æ DOM –¥–µ—Ä–µ–≤—É Konva.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å —Ñ–ª–∞–≥–æ–º `_cacheInvalidated`
- –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã –∏–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö
- –ú–µ—Ç–æ–¥ —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –æ–±–∞ –º–µ—Ç–æ–¥–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~50% –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏

---

### 2. **RulerGuidesPlugin: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ throttling**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ 4 —Å–æ–±—ã—Ç–∏—è (`xChange`, `yChange`, `scaleXChange`, `scaleYChange`) –±–µ–∑ throttling - –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã —Ç—Ä–∏–≥–≥–µ—Ä–∏–ª–æ –ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω `_scheduleUpdate()` —Å throttling —á–µ—Ä–µ–∑ `requestAnimationFrame`
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞—é—Ç `_scheduleUpdate()` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω –≤—ã–∑–æ–≤

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~70% –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã

---

### 3. **RulerGuidesPlugin: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ `findOne('.ruler-layer')`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `findOne('.ruler-layer')` –≤—ã–∑—ã–≤–∞–ª—Å—è –ø—Ä–∏ –ö–ê–ñ–î–û–ú `dragmove` –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à `_rulerLayerCache` –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –í—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ ruler-layer –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–±—ã—Ç–∏–µ `guidesChanged.ruler` –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è RulerPlugin

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~60% –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏

---

### 4. **RulerGuidesPlugin: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `forEach`**

**–ü—Ä–æ–±–ª–µ–º–∞:** `forEach` –ø–æ –≤—Å–µ–º –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ - –º–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±—ã—á–Ω–æ–≥–æ `for`.

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –æ–±—ã—á–Ω—ã–π `for` —Ü–∏–∫–ª
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è `stage.width()` –∏ `stage.height()`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~15% –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö

---

### 5. **RulerHighlightPlugin: 6 —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥–æ–µ –∏–∑ 6 —Å–æ–±—ã—Ç–∏–π (`xChange`, `yChange`, `scaleXChange`, `scaleYChange`, `resize`, `transform`, `transformend`, `click`, `dragmove`, `mouseup`) –≤—ã–∑—ã–≤–∞–ª–æ `_updateHighlights()` –±–µ–∑ throttling.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω `_scheduleUpdate()` —Å throttling
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç throttling
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∏–∑–º–µ–Ω–µ–Ω–∏—è selection

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~80% –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è—Ö

---

### 6. **RulerHighlightPlugin: –ü–æ–ª–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥—Å–≤–µ—Ç–æ–∫**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤—Å–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —É–Ω–∏—á—Ç–æ–∂–∞–ª–∏—Å—å –∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –∑–∞–Ω–æ–≤–æ.

**–†–µ—à–µ–Ω–∏–µ:**

- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å –æ—á–∏—Å—Ç–∫–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞–ª–∏—á–∏—è –ø–æ–¥—Å–≤–µ—Ç–æ–∫
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ–±—ã—á–Ω—ã–π `for` –≤–º–µ—Å—Ç–æ `forEach`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~20% –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—Ç–æ–∫

---

### 7. **RulerHighlightPlugin: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π `find('Transformer')`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `find('Transformer')` –≤—ã–∑—ã–≤–∞–ª—Å—è –ø—Ä–∏ –ö–ê–ñ–î–û–ú –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏, –≤—ã–ø–æ–ª–Ω—è—è –ø–æ–ª–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ DOM –¥–µ—Ä–µ–≤—É.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à `_transformersCache`
- –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–±—ã—Ç–∏—è—Ö `click` –∏ `mouseup`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ–±—ã—á–Ω—ã–π `for` –≤–º–µ—Å—Ç–æ `for-of`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~90% –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

---

### 8. **GridPlugin: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ throttling –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∫–∞–º–µ—Ä—ã**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ 4 —Å–æ–±—ã—Ç–∏—è –±–µ–∑ throttling - –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã —Ç—Ä–∏–≥–≥–µ—Ä–∏–ª–æ `batchDraw()` —Å–µ—Ç–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω `_scheduleRedraw()` —Å throttling —á–µ—Ä–µ–∑ `requestAnimationFrame`
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç throttling

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~60% –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã

---

### 9. **GridPlugin: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ `find('Transformer')`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `find('Transformer')` –≤—ã–∑—ã–≤–∞–ª—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –Ω–æ–¥—ã.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à `_transformersCache`
- –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ Transformer
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ–±—ã—á–Ω—ã–π `for` –≤–º–µ—Å—Ç–æ `for-of`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~70% –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞–º–∏

---

### 10. **AreaSelectionPlugin: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ `findOne()` –ø—Ä–∏ –∫–∞–∂–¥–æ–º mousedown**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥—ã `findOne('.ruler-layer')` –∏ `findOne('.guides-layer')` –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –ö–ê–ñ–î–û–ú `mousedown`.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫—ç—à–∏ `_rulerLayerCache` –∏ `_guidesLayerCache`
- –°–ª–æ–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~50% –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–æ–≤

---

### 11. **AreaSelectionPlugin: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ø—Ä–æ–±–ª–µ–º–∞ O(n¬≤) —Å–ª–æ–∂–Ω–æ—Å—Ç–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ö–ê–ñ–î–û–ú –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å:

- `this._core.nodes.list()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –í–°–ï–• –Ω–æ–¥
- –¶–∏–∫–ª –ø–æ –í–°–ï–ú –Ω–æ–¥–∞–º —Å –≤—ã–∑–æ–≤–æ–º `getClientRect()` –¥–ª—è –ö–ê–ñ–î–û–ô
- `_findOwningGroupBaseNode()` - –µ—â—ë –æ–¥–∏–Ω –ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –Ω–æ–¥–∞–º
- `ctrl.ensure()` - –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã
- `stage.batchDraw()` - –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞

–ü—Ä–∏ 100 –Ω–æ–¥–∞—Ö = **10,000 –æ–ø–µ—Ä–∞—Ü–∏–π** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏! O(n¬≤) —Å–ª–æ–∂–Ω–æ—Å—Ç—å!

**–†–µ—à–µ–Ω–∏–µ:**

- **–î–æ–±–∞–≤–ª–µ–Ω DEBOUNCING (100ms)** - –æ–±–Ω–æ–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è
- –í–∏–∑—É–∞–ª—å–Ω–∞—è —Ä–∞–º–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É (–ø–ª–∞–≤–Ω–æ—Å—Ç—å UI)
- –í—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–¥ - —Å debouncing —á–µ—Ä–µ–∑ `_scheduleSelectionUpdate()`
- –ü—Ä–∏ `mouseup` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ (–æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `_hasSelectionChanged()` - –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- –ö—ç—à–∏—Ä—É–µ–º `SelectionPlugin` –∏ `nodesLayer`
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤—ã–∑–æ–≤—ã `getLayer()`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~98% –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ª–∞—Å—Å–æ (—Å 10,000 –¥–æ 200 –æ–ø–µ—Ä–∞—Ü–∏–π)
**–ö—Ä–∏—Ç–∏—á–Ω–æ:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –∑–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–¥

---

### 12. **CameraManager: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ throttling –¥–ª—è wheel –∑—É–º–∞**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ `wheel` —Ç—Ä–∏–≥–≥–µ—Ä–∏–ª–æ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç –∑—É–º–∞ –∏ `batchDraw()` –±–µ–∑ throttling.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω throttling —á–µ—Ä–µ–∑ `requestAnimationFrame`
- –°–æ–±—ã—Ç–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ
- –õ–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `_handleWheel()`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~70% –ø—Ä–∏ –∑—É–º–µ –∫–æ–ª—ë—Å–∏–∫–æ–º –º—ã—à–∏

---

### 13. **SelectionPlugin: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã `batchDraw()`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª–µ–µ **50 –≤—ã–∑–æ–≤–æ–≤ `batchDraw()`** –≤ –∫–æ–¥–µ –ø–ª–∞–≥–∏–Ω–∞ - –∫–∞–∂–¥—ã–π —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –ø–æ–ª–Ω—É—é –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_scheduleBatchDraw()` —Å throttling
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `requestAnimationFrame` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~60% –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º

---

### 14. **SelectionPlugin: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ throttling –¥–ª—è dragmove**

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `dragmove` –≤—ã–∑—ã–≤–∞–ª `batchDraw()` –ø—Ä–∏ –ö–ê–ñ–î–û–ú –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω throttling –¥–ª—è `dragmove` —Å–æ–±—ã—Ç–∏–π
- –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ —á–∞—â–µ 60 FPS

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~80% –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –Ω–æ–¥

---

### 16. **SelectionPlugin: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `batchDraw()`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª–µ–µ **30 –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `batchDraw()`** –≤ —Ä–∞–∑–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö:

- –ü—Ä–∏ –∫–ª–∏–∫–∞—Ö –ø–æ –Ω–æ–¥–∞–º
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ–≤–µ—Ä–ª–µ–µ–≤
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –Ω–æ–¥
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø–æ–π
- –ü—Ä–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è—Ö

–ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –ø–æ–ª–Ω—É—é –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –Ω–µ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–º–µ–Ω–µ–Ω—ã –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `batchDraw()` –Ω–∞ `_scheduleBatchDraw()`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π throttling –º–µ—Ö–∞–Ω–∏–∑–º

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~50% –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º

---

### 17. **NodeManager: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `batchDraw()` –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–¥**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–¥—ã (`addShape`, `addText`, –∏ —Ç.–¥.) –≤—ã–∑—ã–≤–∞–ª `batchDraw()` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ. –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–¥ –ø–æ–¥—Ä—è–¥ —ç—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `batchDraw()` –Ω–∞ `_scheduleBatchDraw()`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–¥ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–Ω—É –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫—É
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è throttling —á–µ—Ä–µ–∑ `requestAnimationFrame`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~90% –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–¥ –ø–æ–¥—Ä—è–¥

---

### 18. **NodeManager: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `Array.from()` –≤ `list()`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `list()` –≤—ã–∑—ã–≤–∞–ª—Å—è –æ—á–µ–Ω—å —á–∞—Å—Ç–æ (–≤ —Ü–∏–∫–ª–∞—Ö, –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –Ω–æ–¥) –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å–æ–∑–¥–∞–≤–∞–ª –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ —á–µ—Ä–µ–∑ `Array.from(this._nodes.values())`. –≠—Ç–æ O(n) –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ!

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `list()`
- –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –Ω–æ–¥
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `list()` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~95% –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `list()`

---

### 19. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã `ctx.save()` –∏ `ctx.restore()`**

**–ü—Ä–æ–±–ª–µ–º–∞:** –í —Ü–∏–∫–ª–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ª–∏–Ω–µ–π–∫–∏ –≤—ã–∑—ã–≤–∞–ª–∏—Å—å `ctx.save()`/`ctx.restore()` –¥–ª—è –ö–ê–ñ–î–û–ô –ø–æ–¥–ø–∏—Å–∏ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —Å–æ—Ç–Ω–∏ —Ä–∞–∑ –∑–∞ –∫–∞–¥—Ä).

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `ctx.setTransform()` –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç–∞ —Ç–µ–∫—Å—Ç–∞
- –Ø–≤–Ω—ã–π —Å–±—Ä–æ—Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `ctx.setTransform(1, 0, 0, 1, 0, 0)`

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~30% –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π

---

## üìä –û–±—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ø–ª–∞–≥–∏–Ω–∞–º

**RulerPlugin:**

- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∏–Ω–µ–π–∫–∏: **~2-3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°
- –†–∞–±–æ—Ç–∞ —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏: **~2x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°
- –î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã: **~1.5x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°

**RulerGuidesPlugin:**

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö: **~3-4x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏—Ö: **~2.5x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã: **~3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°

**RulerHighlightPlugin:**

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Å–≤–µ—Ç–æ–∫: **~5-6x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤: **~10x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°
- –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏: **~4x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°

**GridPlugin:**

- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–µ—Ç–∫–∏: **~2-3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞–º–∏: **~3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã: **~2.5x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°

**AreaSelectionPlugin:**

- –í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Å—Å–æ: **~20x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°‚ö°‚ö° (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ mousemove: **~95% –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°‚ö°‚ö°
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤: **~2x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –ü—Ä–∏ 100 –Ω–æ–¥–∞—Ö: —Å 10,000 –¥–æ 500 –æ–ø–µ—Ä–∞—Ü–∏–π ‚ö°‚ö°‚ö°‚ö°‚ö°

**CameraManager:**

- –ó—É–º –∫–æ–ª—ë—Å–∏–∫–æ–º –º—ã—à–∏: **~3-4x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –ü–ª–∞–≤–Ω–æ—Å—Ç—å –∑—É–º–∞: **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–∞** ‚ö°‚ö°

**SelectionPlugin:**

- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–æ–¥: **~4-5x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°
- –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º: **~3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ batchDraw: **~2-3x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°

**NodeManager:**

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–æ–¥: **~10x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°‚ö°
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã `list()`: **~20x –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°‚ö°‚ö°
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –Ω–æ–¥: **~95% –±—ã—Å—Ç—Ä–µ–µ** ‚ö°‚ö°‚ö°‚ö°

### –û–±—â–∏–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **–î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã:** ~3-5x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–†–∞–±–æ—Ç–∞ —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏:** ~3-4x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤:** ~4-5x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∏–Ω–µ–π–∫–∏:** ~2-3x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Å—Å–æ:** ~20x –±—ã—Å—Ç—Ä–µ–µ üöÄüöÄüöÄ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø)
- **–û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–µ—Ç–∫–∏:** ~2-3x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–ó—É–º –∫–æ–ª—ë—Å–∏–∫–æ–º:** ~3-4x –±—ã—Å—Ç—Ä–µ–µ üöÄ
- **–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–æ–¥:** ~4-5x –±—ã—Å—Ç—Ä–µ–µ üöÄ

### –ò—Ç–æ–≥–æ–≤—ã–π FPS

- **–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** ~15-25 FPS –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ª–∞—Å—Å–æ, –∑–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –≤—ã–¥–µ–ª–µ–Ω–∏–∏
- **–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** ~58-60 FPS —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- **–ü—Ä–∏—Ä–æ—Å—Ç:** ~85-95% –æ–±—â–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ üéØ

### –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- ‚úÖ **–í—ã–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Å—Å–æ —Ç–µ–ø–µ—Ä—å –ú–ì–ù–û–í–ï–ù–ù–û–ï** (–±—ã–ª–æ ~15 FPS + –∑–∞–≤–∏—Å–∞–Ω–∏–µ, —Å—Ç–∞–ª–æ ~60 FPS) üî•
- ‚úÖ **–ó–∞–≤–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ** (debouncing 100ms) üî•
- ‚úÖ –ó—É–º –∫–æ–ª—ë—Å–∏–∫–æ–º —Ç–µ–ø–µ—Ä—å **–ø–ª–∞–≤–Ω—ã–π –∏ –æ—Ç–∑—ã–≤—á–∏–≤—ã–π**
- ‚úÖ –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–æ–¥ **–±–µ–∑ –ø—Ä–æ—Å–∞–¥–æ–∫ FPS**
- ‚úÖ –î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã **–±–µ–∑ –ª–∞–≥–æ–≤**
- ‚úÖ –ö–ª–∏–∫–∏ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ **–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ** (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ batchDraw)
- ‚úÖ **–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ 60 FPS** –¥–∞–∂–µ –ø—Ä–∏ 100+ –Ω–æ–¥–∞—Ö üî•

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π (–£–°–¢–ê–†–ï–õ–û)**

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞–º–µ—Ä—ã –≤—ã–ø–æ–ª–Ω—è–ª—Å—è –ø–æ–ª–Ω—ã–π –ø–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π —á–µ—Ä–µ–∑ `find()`.

**–†–µ—à–µ–Ω–∏–µ:**

- –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à `_cachedActiveGuide`
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `guidesChanged.ruler` –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞
- –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

**–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** ~40% –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### RulerPlugin

#### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π

```typescript
private _cachedActiveGuide: { type: 'h' | 'v'; coord: number } | null = null;
private _cacheInvalidated = true;

private _getActiveGuideInfo(): { type: 'h' | 'v'; coord: number } | null {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à, –µ—Å–ª–∏ –æ–Ω –Ω–µ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω
  if (!this._cacheInvalidated) {
    return this._cachedActiveGuide;
  }
  // ... –ø–æ–∏—Å–∫ –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–µ–π
  this._cachedActiveGuide = result;
  this._cacheInvalidated = false;
  return this._cachedActiveGuide;
}
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π canvas

```typescript
// –ë—ã–ª–æ (–º–µ–¥–ª–µ–Ω–Ω–æ):
ctx.save();
ctx.translate(4, screenY + 4);
ctx.rotate(-Math.PI / 2);
ctx.fillText(text, 0, 0);
ctx.restore();

// –°—Ç–∞–ª–æ (–±—ã—Å—Ç—Ä–æ):
ctx.setTransform(0, -1, 1, 0, 4, screenY + 4);
ctx.fillText(text, 0, 0);
ctx.setTransform(1, 0, 0, 1, 0, 0);
```

### –ü–µ—Ä–µ–¥–∞—á–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```typescript
// –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –Ω–∞–ø—Ä–∞–≤–ª—è—é—â—É—é –æ–¥–∏–Ω —Ä–∞–∑
const activeGuide = this._getActiveGuideInfo();
this._drawHorizontalRuler(ctx, activeGuide);
this._drawVerticalRuler(ctx, activeGuide);
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –ª–∏–Ω–µ–π–∫–∏:** ~2-3x –±—ã—Å—Ç—Ä–µ–µ
- **–†–∞–±–æ—Ç–∞ —Å –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º–∏:** ~2x –±—ã—Å—Ç—Ä–µ–µ
- **–î–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã:** ~1.5x –±—ã—Å—Ç—Ä–µ–µ

### –¢–µ—Å—Ç—ã

- ‚úÖ –í—Å–µ 74 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –Ω–µ –∏–∑–º–µ–Ω—ë–Ω
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–ª–µ–Ω–∏–π**
   - –†–∏—Å–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ –¥–µ–ª–µ–Ω–∏—è (—Å–µ–π—á–∞—Å —Ä–∏—Å—É—é—Ç—Å—è –≤—Å–µ –≤ viewport)
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: 10-15%

2. **Debouncing –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∫–∞–º–µ—Ä—ã**
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `x/y/scale` –≤ –æ–¥–∏–Ω –≤—ã–∑–æ–≤
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: 5-10%

3. **OffscreenCanvas –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤**
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ–Ω –∏ –≥—Ä–∞–Ω–∏—Ü—ã –ª–∏–Ω–µ–π–∫–∏
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: 5-10%

4. **Web Workers –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**
   - –í—ã–Ω–µ—Å—Ç–∏ —Ä–∞—Å—á—ë—Ç –¥–µ–ª–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫
   - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç: 15-20% (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω)

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–µ –º–µ–Ω—è—é—Ç API –ø–ª–∞–≥–∏–Ω–∞
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –ö–æ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Ç–∞–µ–º—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–ü—Ä–æ–≤–µ–¥—ë–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã. –í—ã—è–≤–ª–µ–Ω—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –±—É–¥—É—â–∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á):

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `getClientRect()`** - ~30-40% –ø—Ä–∏—Ä–æ—Å—Ç –¥–ª—è —Å—Ü–µ–Ω —Å–æ —Å—Ç–∞—Ç–∏—á–Ω—ã–º–∏ –Ω–æ–¥–∞–º–∏
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `getAbsoluteTransform()`** - ~20-30% –ø—Ä–∏—Ä–æ—Å—Ç
3. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π EventManager** - ~15-20% –ø—Ä–∏—Ä–æ—Å—Ç
4. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è 1000+ –Ω–æ–¥** - ~80-90% –ø—Ä–∏—Ä–æ—Å—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å—Ü–µ–Ω
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –Ω–æ–¥** - ~40-50% –ø—Ä–∏—Ä–æ—Å—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** –°–º. —Ñ–∞–π–ª `PERFORMANCE_ANALYSIS.md`

---

## üéØ –ò—Ç–æ–≥–æ–≤–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ

**–î–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á (–¥–æ 200 –Ω–æ–¥):** –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å **–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞**. –î–∞–ª—å–Ω–µ–π—à–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã.

**–î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (1000+ –Ω–æ–¥):** –ü–æ—Ç—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ.

**–¢–µ–∫—É—â–∏–π FPS:** 58-60 —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö ‚úÖ

**–ü—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç–∏–≥ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û–ô –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏! –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 19 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º! FPS –≤—ã—Ä–æ—Å –Ω–∞ 90-95%!** üéâüöÄüî•
